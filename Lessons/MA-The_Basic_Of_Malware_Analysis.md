# The basic of malware analysis

## NIST

Malware, also known as malicious code, refers to a program that compromises
the confidentiality, integrity, or availability of the victim’s data,
applications, or operating system.

## ENISA

The word Malware is derived from the term 'Malicious Software'. Any piece of
software that performs undesirable operations such as data theft or some other
type of computer compromise can be categorised as Malware.

## SANS

Malware is software or computer program used to perform malicious actions.
In fact, the term malware is a combination of the words malicious and software.
Cyber-criminals install malware on your computers or devices to gain control
over them or gain access to what they contain. Once installed, these attackers
can use malware to spy on your online activities, steal your passwords and files,
or use your system to attack others. Malware can even deny access to your own
files, demanding that you pay the attacker a ransom to regain control of them.

## Types of malware

Malware is a broad term that can refer to various types of malicious programs.
The symptoms caused by these different types of malware may sometimes
be similar. However, they mainly differ in the way they spread and infect
systems.

| Type                         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Viruses                      | A virus self-replicates by inserting copies of itself into host programs or data files. Viruses are often triggered through user  interaction, such as opening a file or running a program. Viruses can be divided into the following two subcategories: – Compiled Viruses. A compiled virus is executed by an operating system. Types of compiled viruses include file infector viruses, which attach themselves to executable programs; boot sector viruses, which infect the master boot records of hard drives or the boot sectors of removable media; and multipartite viruses, which combine the characteristics of file infector and boot sector viruses.  –Interpreted Viruses. Interpreted viruses are executed by an application. Within this subcategory, macro viruses take advantage of the capabilities of applications’ macro programming language to infect application documents and document templates, while scripting viruses infect scripts that are understood by scripting languages processed by services on the OS. |
| Worms                        | A worm is a self-replicating, self-contained program that usually executes itself without user intervention. Worms are divided into two categories:  – Network Service Worms. A network service worm takes advantage of a vulnerability in a network service to propagate itself and infect other hosts.  – Mass Mailing Worms. A mass-mailing worm is similar to an email-borne virus but is self-contained, rather than infecting an existing file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Trojan Horses                | A Trojan horse is a self-contained, non-replicating program that, while appearing to be benign, actually has a hidden malicious purpose. Trojan horses either replace existing files with malicious versions or add new malicious files to hosts. They often deliver other attacker tools to hosts.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Malicious Mobile Code        | Malicious mobile code is software with malicious intent that is  transmitted from a remote host to a local host and then executed on the local host, typically without the user’s explicit instruction. Popular languages for malicious mobile code include Java, ActiveX, JavaScript, and VBScript.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Blended Attacks              | A blended attack uses multiple infection or transmission methods. For example, a blended attack could combine the propagation methods of viruses and worms.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Backdoors                    | A backdoor is a malicious program that listens for commands on a  certain TCP or UDP port. Most backdoors allow an attacker to perform a certain set of actions on a host, such as acquiring passwords or executing arbitrary commands.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Keystroke Loggers            | A keystroke logger monitors and records keyboard use. Some require the attacker to retrieve the data from the host, whereas other loggers actively transfer the data to another host through email, file transfer, or other means.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Rootkit                      | A rootkit is a collection of files that is installed on a host to alter its standard functionality in a malicious and stealthy way. A rootkit typically makes many changes to a host to hide the  rootkit’s existence, making it very difficult to determine that the rootkit is present and to identify what the rootkit has changed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Web Browser Plug-Ins         | A web browser plug-in provides a way for certain types of content to be displayed or executed through a web browser. Malicious web browser plug-ins can monitor all use of a browser.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| E-Mail Generators            | An email generating program can be used to create and send large quantities of email, such as malware and spam, to other hosts without the user’s permission or knowledge.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Attacker Toolkits            | Many attackers use toolkits containing several different types of utilities and scripts that can be used to probe and attack hosts, such as packet sniffers, port scanners, vulnerability scanners, password crackers, and attack programs and scripts.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Botnet                       | Malicious code that installs itself onto a computer to allow the attacker access. Backdoors usually let the attacker connect to the computer with little or no authentication and execute commands on the local system.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Downloader                   | Malicious code that exists only to download other malicious code. Downloaders are commonly installed by attackers when they first gain access to a system. The downloader program will download and install additional malicious code.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Information-stealing malware | Malware that collects information from a victim’s computer and usually sends it to the attacker. Examples include sniffers, password hash grabbers, and keyloggers. This malware is typically used to gain access to online accounts such as email or online banking.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Launcher                     | Malicious program used to launch other malicious programs.  Usually, launchers use nontraditional techniques to launch other malicious programs in order to ensure stealth or greater access to a system.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Scareware                    | Malware designed to frighten an infected user into buying something. It usually has a user interface that makes it look like an antivirus or other security program. It informs users that there is malicious code on their system and that the only way to get rid of it is to buy their “software,” when in reality, the software it’s selling does nothing more than removing the scareware.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Ransomware                   | It is a type of malware that encrypts a user’s data and asks a ransom (in bitcoins) in order to decrypt them.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |

## Malware analysis

Malware analysis is a process that uses various tools and techniques to determine
how malicious code is working. Unfortunately, there is no single algorithm to
indicate how to analyse such code. Various approaches are usually needed including
static analysis, behavioural analysis, executable debugging or analysis of
disassembled code. Moreover, each analyst usually tends to have his or her own
favourite techniques and preferred tools.

## Types of malware analysis

### Basic static analysis

### Basic dynamic analysis

### Advanced static analysis

### Advanced dynamic analysis

### Automatic analysis

### Network analysis

### Memory forensic analysis

## Goals of malware analysis

Because malware analysis is usually a complex task, it is always important to have
a clear goal in mind. Some common analysis goals are: determining infection
indicators in order to detect other infected computers, determining malware 
propagation mechanism to more effectively prevent future infections or getting to
know malicious code functionality to assess the risk associated with potential
infection. Malware samples are usually quite complex. Some samples are fairly easy
to analyse while others require a deep knowledge of system internals and advanced 
reverse engineering skills to analyse. In general, to perform basic malware analysis 
some basic system administration knowledge and programming background is needed.
And on the network level it is good to know the network stack and have some knowledge
about popular network protocols (ICMP,TCP, UDP, HTTP, FTP, SMTP, IRC, etc.).

## References

[https://www.enisa.europa.eu/topics/trainings-for-cybersecurity-specialists/online-training-material/documents/building-artifact-handling-and-analysis-environment-handbook](https://www.enisa.europa.eu/topics/trainings-for-cybersecurity-specialists/online-training-material/documents/building-artifact-handling-and-analysis-environment-handbook)\
[http